[pytest]
# Pytest Configuration for Vibe Coder CLI

# Test Discovery
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*
addopts =
    -v
    --strict-markers
    --strict-config
    --cov=vibe_coder
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-report=xml
    --cov-fail-under=80
    --tb=short
    --durations=10

# Async Test Configuration
asyncio_mode = auto

# Markers Configuration
markers =
    # Test Type Markers
    unit: Mark test as a unit test (fast, isolated)
    integration: Mark test as an integration test (requires external dependencies)
    e2e: Mark test as an end-to-end test (full workflow testing)

    # Performance Markers
    slow: Mark test as slow running (takes > 1 second)
    performance: Mark test as a performance benchmark

    # Dependency Markers
    network: Mark test as requiring network access
    github: Mark test as requiring GitHub API access
    database: Mark test as requiring database connection

    # Feature-Specific Markers
    cli: Mark test as testing CLI commands
    config: Mark test as testing configuration management
    api: Mark test as testing API clients
    intelligence: Mark test as testing intelligence module
    healing: Mark test as testing auto-healing functionality
    analytics: Mark test as testing analytics/cost tracking
    plugins: Mark test as testing plugin system
    mcp: Mark test as testing MCP (Model Context Protocol) integration
    slash: Mark test as testing slash commands

    # Provider-Specific Markers
    openai: Mark test as testing OpenAI integration
    anthropic: Mark test as testing Anthropic integration
    ollama: Mark test as testing Ollama integration
    generic: Mark test as testing generic provider support

    # Module Markers
    commands: Mark test as testing command module
    types: Mark test as testing type definitions
    utils: Mark test as testing utility functions
    prompts: Mark test as testing prompt templates

    # Special Test Categories
    security: Mark test as security-related
    reliability: Mark test as reliability/fault-tolerance testing
    compatibility: Mark test as compatibility testing

# Minimum Version
minversion = 6.0

# Test Session Configuration
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Logging Configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Console Output Settings
console_output_style = progress

# Coverage Settings
[coverage:run]
source = vibe_coder
omit =
    */tests/*
    */test_*
    setup.py
    */venv/*
    */.venv/*
    */dist/*
    */build/*
    */__pycache__/*

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    if self.debug:
    if settings.DEBUG
    raise AssertionError
    raise NotImplementedError
    if 0:
    if __name__ == .__main__.:
    class .*\bProtocol\):
    @(abc\.)?abstractmethod
    @overload

[coverage:html]
directory = htmlcov

# Test Parallelization (if pytest-xdist is installed)
# To enable parallel tests, install pytest-xdist and uncomment:
# addopts = -n auto

# JUnit XML Output (for CI integration)
# To enable JUnit XML reports:
# junit_family = xunit2
# junit_logging = all
# junit_log_passing_tests = True